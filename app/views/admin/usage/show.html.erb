<h1 class='text-center text-primary my-2'>Subscribed Plans</h1>
<% if @bill.payment? %>
  <h3> <span class="badge rounded-pill bg-success">Paid</span> </h3>
<% else %>
  <h3> <span class="badge rounded-pill bg-danger">Not Paid</span> </h3>
<% end %>
<% @subscriptions.each do |subscription| %>
  <ul class='list-group'>
    <li class='list-group-item'>
      <strong class='text-primary'>Subscription Name: </strong>
      <%= subscription.subscription_name %>
    </li>
    <li class='list-group-item'>
      <strong class='text-primary'>Monthly Fee: </strong> <%= subscription.price %>$
    </li>
    <% subscription.plan.feature_plans.each do |feature_plan| %>
      <li class='list-group-item'>
        <strong class='text-primary'> Feature Name: </strong>
        <%= feature_plan.feature.feature_name %>
      </li>
      <li class='list-group-item'>
        <strong class='text-primary'> Unit Price: </strong>
        <%= feature_plan.feature.unit_price %>$
      </li>
      <li class='list-group-item'>
        <strong class='text-primary'> Max Unit Limit: </strong>
        <%= feature_plan.feature.max_unit_limit %>
      </li>
      <% consume_feature = get_consume_feature(subscription.consume_features, feature_plan.feature.id) %>
      <% if consume_feature %>
        <li class='list-group-item'>
          <strong class='text-primary'> Unit Cosnsumed: </strong>
          <%= consume_feature.consume_units %>
        </li>
      <% end %>
    <% end %>
  </ul>
  <hr class='border border-success border-3'>
<% end %>
<div class='my-3'>
   <%= link_to 'Generate Bill', admin_payments_path(payment: { user_id: @user.id }), method: :create, class: 'btn btn-success'%>
</div>
<% if @bill %>
  <p class='text-center mt-2'>
    <strong class='text-success'>Total Bill: </strong><%= @bill.total_bill %>$</li>
  </p>
<% end %>
